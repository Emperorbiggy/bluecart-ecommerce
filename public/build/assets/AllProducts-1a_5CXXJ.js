import{r as d,j as e}from"./app-Cu4gI7ct.js";import{A as v}from"./AdminLayout-BJ1TDyrl.js";import{g as w,u as I}from"./api-C_pSPt-h.js";import"./BlueCartLoader-DIdU36Zx.js";import"./createLucideIcon-BfVtD7wb.js";import"./log-out-BuneZK1n.js";import"./user-BnYGxcdh.js";function S(){const[h,b]=d.useState("all-products"),[c,y]=d.useState({}),[j,p]=d.useState(!0),[o,u]=d.useState(null),[s,r]=d.useState({name:"",price:"",category:"",shortDescription:"",details:"",discount:"",imageInputType:"url",images:[""],uploadedImages:[null]});d.useEffect(()=>{g()},[]);const g=async()=>{p(!0);const l=(await w()).map(t=>{const n=typeof t.images=="string"?JSON.parse(t.images):t.images;return{...t,images:n}}).reduce((t,n)=>{const m=n.category||"uncategorized";return t[m]||(t[m]=[]),t[m].push(n),t},{});y(l),p(!1)},f=a=>{const i=typeof a.images=="string"?JSON.parse(a.images):Array.isArray(a.images)?a.images:[""];u(a),r({name:a.name,price:a.price,category:a.category,shortDescription:a.short_description||"",details:a.details||"",discount:a.discount||"",imageInputType:"url",images:i,uploadedImages:[null]})},x=()=>{u(null)},N=async()=>{try{let a;s.imageInputType==="upload"?(a=new FormData,a.append("name",s.name),a.append("price",s.price),a.append("category",s.category),a.append("discount",s.discount),a.append("short_description",s.shortDescription),a.append("details",s.details),s.uploadedImages.forEach((i,l)=>{i&&a.append("images[]",i)})):a={name:s.name,price:s.price,category:s.category,discount:s.discount,short_description:s.shortDescription,details:s.details,images:s.images},await I(o.id,a),x(),g()}catch(a){alert("Update failed"),console.error(a)}};return e.jsxs(v,{activeTab:h,setActiveTab:b,children:[e.jsx("h2",{className:"text-2xl font-semibold text-osunblue mb-6",children:"All Products"}),j?e.jsx("p",{children:"Loading products..."}):Object.entries(c).length===0?e.jsx("p",{children:"No products found."}):Object.entries(c).map(([a,i])=>e.jsxs("div",{className:"mb-10",children:[e.jsx("h3",{className:"text-lg font-bold capitalize text-gray-700 mb-4",children:a.replace("_"," ")}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:i.map(l=>{var t;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow flex flex-col",children:[e.jsx("img",{src:((t=l.images)==null?void 0:t[0])||"/placeholder.png",alt:l.name,className:"w-full h-40 object-cover"}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:l.name}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["₦",l.price.toLocaleString()]}),e.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full",children:"Active"})]}),e.jsx("button",{onClick:()=>f(l),className:"mt-4 bg-osunblue hover:bg-blue-900 text-white text-sm px-4 py-2 rounded-md transition",children:"Edit"})]})]},`${a}-${l.id}-${l.name}`)})})]},a)),o&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white w-full max-w-md p-6 rounded-xl shadow-lg overflow-y-auto max-h-[90vh]",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 text-gray-800",children:["Edit Product: ",o.name]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),N()},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:s.name,onChange:a=>r({...s,name:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Price"}),e.jsx("input",{type:"number",value:s.price,onChange:a=>r({...s,price:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Discount (%)"}),e.jsx("input",{type:"number",value:s.discount,onChange:a=>r({...s,discount:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),e.jsx("input",{type:"text",value:s.category,onChange:a=>r({...s,category:a.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Short Description"}),e.jsx("textarea",{value:s.shortDescription,onChange:a=>r({...s,shortDescription:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:2})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Details"}),e.jsx("textarea",{value:s.details,onChange:a=>r({...s,details:a.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:4})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image Input Type"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"imageInputType",value:"url",checked:s.imageInputType==="url",onChange:a=>r({...s,imageInputType:a.target.value})}),e.jsx("span",{className:"ml-1",children:"Image URL"})]}),e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:"imageInputType",value:"upload",checked:s.imageInputType==="upload",onChange:a=>r({...s,imageInputType:a.target.value})}),e.jsx("span",{className:"ml-1",children:"Upload File"})]})]})]}),e.jsxs("div",{className:"mb-4",children:[s.imageInputType==="url"&&s.images.map((a,i)=>e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"url",value:a,onChange:l=>{const t=[...s.images];t[i]=l.target.value,r({...s,images:t})},className:"w-full border border-gray-300 rounded px-2 py-1"}),s.images.length>1&&e.jsx("button",{type:"button",onClick:()=>{const l=s.images.filter((t,n)=>n!==i);r({...s,images:l})},className:"text-red-500",children:"×"})]},i)),s.imageInputType==="upload"&&s.uploadedImages.map((a,i)=>e.jsx("input",{type:"file",accept:"image/*",onChange:l=>{const t=[...s.uploadedImages];t[i]=l.target.files[0],r({...s,uploadedImages:t})},className:"w-full mb-2"},i)),e.jsx("button",{type:"button",className:"text-sm text-blue-600 mt-2",onClick:()=>{s.imageInputType==="url"?r({...s,images:[...s.images,""]}):r({...s,uploadedImages:[...s.uploadedImages,null]})},children:"Add More Images"})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-osunblue text-white rounded-md hover:bg-blue-900",children:"Update"})]})]})]})})]})}export{S as default};
